---
title: Mysql面试题
abbrlink: 6760
date: 2022-04-11 10:23:29
tags:
---

# Mysql面试题

## MySQL中的存储引擎

**常用的存储引擎有以下：**

- **Innodb引擎：**Innodb引擎提供了对数据库ACID事务的支持。并且还提供了行级锁和外键的约束。它的设计的目标就是处理大数据容量的数据库系统。
- **MyIASM引擎(Mysql5.5前的默认引擎)：**不提供事务的支持，也不支持行级锁和外键。
- **MEMORY引擎：**所有的数据都在内存中，数据的处理速度快，但是安全性不高。

**MyISAM与InnoDB区别：**

|                      |                            MyISAM                            |                            Innodb                            |
| :------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: |
|     是否支持事务     |             不支持事务， 但是每次查询都是原子的              |          支持 ACID 的事务， 支持事务的四种隔离级别           |
|        锁支持        |                         支持表级锁定                         |         支持行级锁定、表级锁定，锁定力度小并发能力高         |
|     是否支持外键     |                          不支持外键                          |                           支持外键                           |
|       存储结构       | 每张表被存放在三个文件：索引文件MYI、数据文件MYD、frm表结构文件 | 所有的表都保存在同一个数据文件中（也可以是多个），InnoDB表的大小只受限于操作系统文件的大小，一般为2GB |
|       存储空间       |                 MyISAM可被压缩，存储空间较小                 | InnoDB的表需要更多的内存和存储，它会在主内存中建立其专用的缓冲池用于高速缓冲数据和索引 |
|       文件格式       |          数据和索引是分别存储的，数据.MYD，索引.MYI          |                 数据和索引是集中存储的，.ibd                 |
| 可移植性、备份及恢复 | 跨平台的数据转移中会很方，在备份和恢复时可单独针对某个表进行操作 | 可以拷贝数据文件、备份 binlog，或者用 mysqldump，在数据量达到几十G的时候就相对痛苦了 |
|     记录存储顺序     |                      按记录插入顺序保存                      |                      按主键大小有序插入                      |
|       哈希索引       |                            不支持                            |                             支持                             |
|       全文索引       |                             支持                             |                 不支持(但可以使用Sphinx插件)                 |

> 大多数时候我们使用的都是 InnoDB 存储引擎，在某些读密集的情况下，使用 MyISAM 也是合适的。不过，前提是你的项目不介意 MyISAM 不支持事务、崩溃恢复等缺点。
>
> MyISAM：以读写插入为主的应用程序，比如博客系统、新闻门户网站。
> Innodb：更新（删除）操作频率也高，或者要保证数据的完整性；并发量高，支持事务和外键。比如OA自动化办公系统。

## 数据库三大范式

- 第一范式： **属性**不可再分
- 第二范式： 在一范式的基础上，**消除**了部份**依赖**，**属性**完全依赖于**主键**
- 第三范式： 在二范式的基础上，**消除了传递依赖**，属性不依赖于其它非主属性 **属性直接依赖于主键**

## 数据库中的事务是什么?事务的特性？

事务（ transaction） 是一组有序的数据库操作。如果组中的所有操作都成功， 则认为事务成功，提交事务。 如果一个操作失败， 则事务将回滚， 该事务所有操作的影响都将取消。（事务是逻辑上的一组操作，要么都执行，要么都不执行）

1. 原子性（Atomicity） ： 事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用；
2. 一致性（Consistency）： 执行事务前后，数据保持一致，例如转账业务中，无论事务是否成功，转账者和收款人的总额应该是不变的；
3. 隔离性（Isolation）： 并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的；
4. 持久性（Durability）： 一个事务被提交之后。它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响。



## Mysql索引

### 索引是什么

- 官方介绍索引是帮助MySQL**高效获取数据**的**数据结构**。更通俗的说，数据库索引好比是一本书前面的目录，能**加快数据库的查询速度**。
- 一般来说索引本身也很大，不可能全部存储在内存中，因此**索引往往是存储在磁盘上的文件中的**（可能存储在单独的索引文件中，也可能和数据一起存储在数据文件中）。
- **我们通常所说的索引，包括聚集索引、覆盖索引、组合索引、前缀索引、唯一索引等，没有特别说明，默认都是使用B+树结构组织（多路搜索树，并不一定是二叉的）的索引。**

### 索引的优势和劣势

**优势：**

- **可以提高数据检索的效率，降低数据库的IO成本**，类似于书的目录。
- 通过**索引列对数据进行排序**，降低数据排序的成本，降低了CPU的消耗。
  - 被索引的列会自动进行排序，包括【单列索引】和【组合索引】，只是组合索引的排序要复杂一些。
  - 如果按照索引列的顺序进行排序，对应order by语句来说，效率就会提高很多。

**劣势：**

- **索引会占据磁盘空间**
- **索引虽然会提高查询效率，但是会降低更新表的效率**。比如每次对表进行增删改操作，MySQL不仅要保存数据，还有保存或者更新对应的索引文件。

## 索引类型

**主键索引**

索引列中的值必须是唯一的，不允许有空值。

**普通索引**

MySQL中基本索引类型，没有什么限制，允许在定义索引的列中插入重复值和空值。

**唯一索引**

索引列中的值必须是唯一的，但是允许为空值。

**全文索引**

只能在文本类型CHAR,VARCHAR,TEXT类型字段上创建全文索引。字段长度比较大时，如果创建普通索引，在进行like模糊查询时效率比较低，这时可以创建全文索引。 MyISAM和InnoDB中都可以使用全文索引。

**空间索引**

MySQL在5.7之后的版本支持了空间索引，而且支持OpenGIS几何数据模型。MySQL在空间索引这方面遵循OpenGIS几何数据模型规则。

**前缀索引**

在文本类型如CHAR,VARCHAR,TEXT类列上创建索引时，可以指定索引列的长度，但是数值类型不能指定。

## 索引的数据结构

### Hash表

Hash表，在Java中的HashMap，TreeMap就是Hash表结构，以键值对的方式存储数据。我们使用Hash表存储表数据Key可以存储索引列，Value可以存储行记录或者行磁盘地址。Hash表在等值查询时效率很高，时间复杂度为O(1)；但是不支持范围快速查找，范围查找时还是只能通过扫描全表方式。

**显然这种并不适合作为经常需要查找和范围查找的数据库索引使用。**

### 二叉查找树

二叉树，我想大家都会在心里有个图。

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201024113453660.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzM1MTkwNDky,size_16,color_FFFFFF,t_70#pic_center)
